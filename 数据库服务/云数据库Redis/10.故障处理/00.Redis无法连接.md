---
title: Redis无法连接
date: 2021-12-22 17:32:54
permalink: /pages/477053/
article: true
---

## 可能原因

| 可能原因     | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| 网络问题     | 1、云服务器与云数据库Redis不在同一虚拟数据中心<br />2、云服务器与云数据库Redis在同一虚拟数据中心，但不在同一私网网段 |
| 白名单问题   | 白名单中配置的IP地址或IP段不正确                             |
| 密码问题     | 输入的认证密码错误                                           |
| 突发异常事件 | 发生 HA 切换、服务不可用、只读副本切换、只读副本服务不可用等服务异常 |

## 排查及解决方案

### 网络问题

- 排查方法

登录[控制台](https://console.capitalonline.net/dbinstances)检查部署客户端的云服务器和想要连接的目标云数据库Redis是否位于同一虚拟数据中心，且位于同一私网网段。如果不位于同一虚拟数据中心或同一私网网段，则无法通过内网互通。

- 解决方案

方案1：您可以将原实例删除，重新购买同一虚拟数据中心下的实例，选择同一私网网段即可。

方案2：您也可以通过路由打通云服务器所处网络和云数据Redis私网。

### 白名单问题

- 排查方法

在确认网络可通的情况下，连接Redis实例时，如果提示`Could not connect to Redis at 10.XX.XX.10:9736: Connection timed out`，也可能是白名单的设置和使用不正确。

- 解决方案

方案1：如果您的云服务器与Redis实例处于同一私网网段，可以关闭白名单。云数据库Redis支持内网互通，即处于同一内网的云服务器可以直接连接云数据库Redis。

方案2：如果您需要通过白名单限制IP访问，请登录[控制台](https://console.capitalonline.net/dbinstances)，检查用于连接Redis实例的云服务器IP地址或IP段已经成功添加在白名单中。白名单具体操作，详情参见[设置白名单](./../04.快速入门/01.设置白名单.md)。

### 密码问题

- 排查方法

执行下述命令，如果提示`OK`，说明密码没问题。

```
10.XX.XX.3:9736> AUTH 密码
OK
```

如果提示`(error) ERR invalid password`，说明密码错误。

```
10.XX.XX.3:9736> AUTH 密码
(error) ERR invalid password
```

- 解决方案

您可以进入此实例的账号管理页面，进行密码重置即可。详情参见[管理账号](./../05.操作指南/08.账号与密码/00.创建与管理账号.md)。

### 突发异常事件

- 排查方法

登录控制台，进入实例的监控功能页面查看。如果在某个确定的时间点发现连接异常或者有大量的访问报错、慢查询，说明发生了异常事件。查看监控的具体操作，详情参见[监控功能](./../05.操作指南/07.监控告警/01.监控功能.md)。

- 解决方案

请及时联系工作人员获取帮助。

## 客户端连接常见异常

[Csredis客户端常见连接异常](./../10.故障处理/01.使用Csredis客户端时出现Unexpectedendofstream异常.md)

[redis-py客户端常见连接异常](./../10.故障处理/02.使用redis-py客户端时连接集群报错.md)

